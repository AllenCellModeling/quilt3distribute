# Managing Manifests and Distributing Datasets

Jackson Brown
Allen Institute for Cell Science
Seattle, WA, USA
jacksonb@alleninstitute.org

Machine learning and computational modeling methods are increasingly used in both science and industry. A core component of computational modeling research, as with all research, is the affordability and ease of reproducing the results found by an experiment. To ease the challenge of reproducibility, sharing of the dataset used to produce the results of an experiment is commonplace. Methods for managing and distributing these datasets are inappropriate for imaging datasets however because they commonly resemble a manifest and require additional packaging and organization than their feature set counterparts.

It is not clear how to store a dataset that may be made up of thousands of files and accompanying metadata. Containerization of data has been a common theme in recent years with distributing datasets [CITATION NEEDED]. Following suit, our proposal for storage and distribution of manifest style datasets uses a software package that falls under the containerization umbrella. "Quilt" is a software package that adds a number of features to current state of the art storage systems (e.g. Amazon's S3). Of note: Quilt versions dataset containers (what Quilt refers to as data packages), a desired feature for the computational sciences resource stack as versioned file storage supports the goal for having each experiment be easily reproducible.

This project expands on state of the art methods by specifically targeting the distribution of manifest style datasets. For most computational modeling scientists at the Allen Institute for Cell Science, datasets are commonly tabular, with a column, or multiple columns, filled with file paths to larger resources (images). The rest of the tabular dataset is largely metadata about the files referenced in each row. To expand on the state of the art, we have created a Python package that attaches the metadata from columns found in a tabular manifest style dataset to each file found in the manifest before distributing them with Quilt.

To help the end user of the dataset, our package additionally cleans and standardizes the metadata it finds. A few examples of these cleaning and validation behaviors are:

1) Asserting or casting that all values in a metadata column are the most common data type for that metadata column
(Ex: if the values "4" (four), "1" (one), and "'4' (string four)" exist in the same column, the application attempts to cast the string four to an integer four)

2) Enforcing that every file path found actually exists prior to distribution. (Commonly, when collaboratively working on shared datasets, files will move to a new location during the process of development.)

If a manifest has multiple columns that contain file paths to resources the application additionally constructs a lookup table for those shared file associations and places the relevant portion of that lookup table in each file's metadata. An example of this behavior can be seen when an imaging manifest has a column for full size images and a column for thumbnail images. For each row of the manifest, the application makes an entry in the Quilt package that pairs the full size image to the smaller thumbnail image by storing the read path to the other in the metadata for each member of the pair. This is both for useful for navigation around the data package through metadata but also to retain each file's context in relation to the package as a whole.
